---
// 页面元数据
const pageTitle = "JSON Formatter - RuanTools";
const description = "一个美观易用的 JSON 格式化工具，支持语法高亮、错误检测和一键复制。";
---

<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <title>{pageTitle}</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background-color: #f8fafc;
        color: #1e293b;
        min-height: 100vh;
      }
      
      /* 简单的 JSON 语法高亮 CSS */
      .json-highlight {
        background: #1a1a1a;
        color: #f8f8f2;
        padding: 1rem;
        border-radius: 0.5rem;
        font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        font-size: 0.9rem;
        line-height: 1.5;
        overflow-x: auto;
        min-height: 300px;
        white-space: pre-wrap;
        word-wrap: break-word;
      }
      .json-key { color: #f92672; }
      .json-string { color: #a6e22e; }
      .json-number { color: #ae81ff; }
      .json-boolean { color: #fd971f; }
      .json-null { color: #f92672; }
      .json-error { 
        color: #ff5555; 
        background: rgba(255,85,85,0.1); 
        border-left: 4px solid #ff5555;
        padding: 1rem;
      }
      
      /* 容器样式 */
      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }
      
      /* 头部样式 */
      .header {
        text-align: center;
        margin-bottom: 30px;
        padding-bottom: 20px;
        border-bottom: 1px solid #e2e8f0;
      }
      
      .header h1 {
        margin: 0;
        font-size: 2rem;
        color: #0f172a;
      }
      
      .header p {
        color: #64748b;
        margin: 10px 0 0;
      }
      
      /* 主内容区域 */
      .main-content {
        margin-top: 20px;
      }
      
      /* 网格布局 */
      .grid-container {
        display: grid;
        grid-template-columns: 1fr;
        gap: 24px;
      }
      
      @media (min-width: 768px) {
        .grid-container {
          grid-template-columns: 1fr 1fr;
        }
      }
      
      /* 输入/输出区域 */
      .input-output-section {
        display: flex;
        flex-direction: column;
        height: 100%;
      }
      
      .section-label {
        display: block;
        font-weight: 600;
        margin-bottom: 8px;
        color: #374151;
        font-size: 0.875rem;
      }
      
      .input-textarea {
        flex: 1;
        min-height: 400px;
        padding: 16px;
        border: 2px solid #e5e7eb;
        border-radius: 8px;
        font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        font-size: 14px;
        line-height: 1.5;
        resize: vertical;
        outline: none;
        transition: border-color 0.2s;
        background-color: white;
        box-sizing: border-box;
        width: 100%;
      }
      
      .input-textarea:focus {
        border-color: #3b82f6;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      }
      
      .input-textarea::placeholder {
        color: #9ca3af;
      }
      
      /* 按钮区域 */
      .button-group {
        display: flex;
        gap: 12px;
        margin-top: 16px;
        flex-wrap: wrap;
      }
      
      .btn {
        padding: 10px 16px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 500;
        font-size: 14px;
        transition: background-color 0.2s;
      }
      
      .btn-primary {
        background-color: #3b82f6;
        color: white;
      }
      
      .btn-primary:hover {
        background-color: #2563eb;
      }
      
      .btn-secondary {
        background-color: #6b7280;
        color: white;
      }
      
      .btn-secondary:hover {
        background-color: #4b5563;
      }
      
      .btn-success {
        background-color: #10b981;
        color: white;
      }
      
      .btn-success:hover {
        background-color: #059669;
      }
      
      /* 输出区域头部 */
      .output-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 8px;
      }
      
      /* 底部样式 */
      .footer {
        text-align: center;
        padding: 24px 0;
        margin-top: 40px;
        border-top: 1px solid #e2e8f0;
        color: #6b7280;
        font-size: 0.875rem;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- 头部导航 -->
      <header class="header">
        <h1>JSON 格式化工具</h1>
        <p>粘贴或输入 JSON 数据，自动格式化并高亮显示</p>
      </header>

      <!-- 主内容区 -->
      <main class="main-content">
        <div class="grid-container">
          <!-- 输入区域 -->
          <div class="input-output-section">
            <label for="input" class="section-label">输入 JSON</label>
            <textarea
              id="input"
              placeholder='例如：{"name": "张三", "age": 25, "hobbies": ["阅读", "编程"]}'
              class="input-textarea"
              spellcheck="false"
            ></textarea>
          </div>

          <!-- 输出区域 -->
          <div class="input-output-section">
            <div class="output-header">
              <label class="section-label">格式化结果</label>
              <div class="button-group">
                <button id="copyBtn" class="btn btn-success">复制结果</button>
              </div>
            </div>
            <pre id="output" class="json-highlight">等待输入...</pre>
          </div>
        </div>
      </main>

      <!-- 底部信息 -->
      <footer class="footer">
        <p>&copy; 2024 RuanTools - 在线工具集合</p>
      </footer>
    </div>

    <script>
      const inputEl = document.getElementById('input');
      const outputEl = document.getElementById('output');
      const copyBtn = document.getElementById('copyBtn');

      // 简单的 JSON 语法高亮函数
      function highlightJson(jsonStr) {
        try {
          const obj = JSON.parse(jsonStr);
          const formatted = JSON.stringify(obj, null, 2);
          
          // 简单的关键字替换高亮
          return formatted
            .replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?)/g, (match) => {
              if (match.endsWith(':')) {
                return `<span class="json-key">${match}</span>`;
              } else {
                return `<span class="json-string">${match}</span>`;
              }
            })
            .replace(/\b(true|false|null)\b/g, '<span class="json-boolean">$1</span>')
            .replace(/\b\d+\b/g, '<span class="json-number">$&</span>');
        } catch (e) {
          return `<span class="json-error">❌ 错误: ${e.message}</span>`;
        }
      }

      // 实时格式化
      inputEl.addEventListener('input', () => {
        const value = inputEl.value.trim();
        if (value) {
          outputEl.innerHTML = highlightJson(value);
        } else {
          outputEl.textContent = '等待输入...';
        }
      });

      // 复制功能
      copyBtn.addEventListener('click', async () => {
        try {
          const text = outputEl.textContent;
          if (text && text !== '等待输入...' && !text.includes('❌ 错误')) {
            await navigator.clipboard.writeText(text);
            copyBtn.textContent = '已复制!';
            setTimeout(() => { copyBtn.textContent = '复制结果'; }, 1500);
          }
        } catch (e) {
          console.error('复制失败:', e);
        }
      });
    </script>
  </body>
</html>

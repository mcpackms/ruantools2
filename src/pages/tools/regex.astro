---
// src/pages/tools/regex.astro
import Layout from '../../layouts/Layout.astro';
import RegexTester from '../../components/RegexTester.jsx';

const pageTitle = '正则表达式测试工具';
const description = '在线测试、调试和验证正则表达式，支持多种模式和实时高亮显示匹配结果';
---

<Layout title={`${pageTitle} | 软糖工具`}>
  <div class="container mx-auto px-4 py-8 max-w-6xl">
    <!-- 页面标题和描述 -->
    <div class="mb-8">
      <h1 class="text-3xl md:text-4xl font-bold text-gray-900 dark:text-gray-100 mb-4">
        {pageTitle}
      </h1>
      <p class="text-lg text-gray-600 dark:text-gray-400">
        {description}
      </p>
    </div>

    <!-- 工具主界面 -->
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden mb-8">
      <div class="p-6">
        <RegexTester client:load />
      </div>
    </div>

    <!-- 正则表达式速查表 -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
      <!-- 字符类 -->
      <div class="bg-gray-50 dark:bg-gray-900 rounded-xl p-6">
        <h2 class="text-xl font-bold text-gray-900 dark:text-gray-100 mb-4">
          字符类
        </h2>
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
            <thead>
              <tr>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">模式</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">描述</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
              <tr><td class="px-4 py-2 font-mono">.</td><td>匹配除换行符外的任意字符</td></tr>
              <tr><td class="px-4 py-2 font-mono">\d</td><td>数字，等同于 [0-9]</td></tr>
              <tr><td class="px-4 py-2 font-mono">\D</td><td>非数字，等同于 [^0-9]</td></tr>
              <tr><td class="px-4 py-2 font-mono">\w</td><td>单词字符，等同于 [A-Za-z0-9_]</td></tr>
              <tr><td class="px-4 py-2 font-mono">\W</td><td>非单词字符</td></tr>
              <tr><td class="px-4 py-2 font-mono">\s</td><td>空白字符（空格、制表符等）</td></tr>
              <tr><td class="px-4 py-2 font-mono">\S</td><td>非空白字符</td></tr>
              <tr><td class="px-4 py-2 font-mono">[abc]</td><td>匹配括号内的任意一个字符</td></tr>
              <tr><td class="px-4 py-2 font-mono">[^abc]</td><td>匹配不在括号内的任意字符</td></tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- 量词 -->
      <div class="bg-gray-50 dark:bg-gray-900 rounded-xl p-6">
        <h2 class="text-xl font-bold text-gray-900 dark:text-gray-100 mb-4">
          量词
        </h2>
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
            <thead>
              <tr>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">模式</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">描述</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
              <tr><td class="px-4 py-2 font-mono">*</td><td>匹配 0 次或多次</td></tr>
              <tr><td class="px-4 py-2 font-mono">+</td><td>匹配 1 次或多次</td></tr>
              <tr><td class="px-4 py-2 font-mono">?</td><td>匹配 0 次或 1 次</td></tr>
              <tr><td class="px-4 py-2 font-mono">{"{n}"}</td><td>匹配恰好 n 次</td></tr>
              <tr><td class="px-4 py-2 font-mono">{"{n,}"}</td><td>匹配至少 n 次</td></tr>
              <tr><td class="px-4 py-2 font-mono">{"{n,m}"}</td><td>匹配 n 到 m 次</td></tr>
              <tr><td class="px-4 py-2 font-mono">*?</td><td>非贪婪匹配（尽可能少匹配）</td></tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- 锚点与边界 -->
      <div class="bg-gray-50 dark:bg-gray-900 rounded-xl p-6">
        <h2 class="text-xl font-bold text-gray-900 dark:text-gray-100 mb-4">
          锚点与边界
        </h2>
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
            <thead>
              <tr>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">模式</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">描述</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
              <tr><td class="px-4 py-2 font-mono">^</td><td>匹配字符串的开始（多行模式匹配行开始）</td></tr>
              <tr><td class="px-4 py-2 font-mono">$</td><td>匹配字符串的结束（多行模式匹配行结束）</td></tr>
              <tr><td class="px-4 py-2 font-mono">\b</td><td>单词边界</td></tr>
              <tr><td class="px-4 py-2 font-mono">\B</td><td>非单词边界</td></tr>
              <tr><td class="px-4 py-2 font-mono">(?=...)</td><td>正向先行断言</td></tr>
              <tr><td class="px-4 py-2 font-mono">(?!...)</td><td>负向先行断言</td></tr>
              <tr><td class="px-4 py-2 font-mono">{"(?<=...)"}</td><td>正向后行断言</td></tr>
              <tr><td class="px-4 py-2 font-mono">{"(?<!...)"}</td><td>负向后行断言</td></tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- 分组与引用 -->
      <div class="bg-gray-50 dark:bg-gray-900 rounded-xl p-6">
        <h2 class="text-xl font-bold text-gray-900 dark:text-gray-100 mb-4">
          分组与引用
        </h2>
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
            <thead>
              <tr>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">模式</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">描述</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
              <tr><td class="px-4 py-2 font-mono">(...)</td><td>捕获组</td></tr>
              <tr><td class="px-4 py-2 font-mono">(?:...)</td><td>非捕获组</td></tr>
              <tr><td class="px-4 py-2 font-mono">{"(?<name>...)"}</td><td>命名捕获组</td></tr>
              <tr><td class="px-4 py-2 font-mono">\1, \2, ...</td><td>引用捕获组</td></tr>
              <tr><td class="px-4 py-2 font-mono">|</td><td>或（选择）操作</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- 使用场景示例 -->
    <div class="mt-8">
      <h2 class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-4">常见使用场景</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- 场景1 -->
        <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4">
          <h3 class="font-semibold text-gray-800 dark:text-gray-200 mb-2">验证邮箱</h3>
          <div class="space-y-2 text-sm">
            <p class="font-mono text-blue-600 dark:text-blue-400 break-words">^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{"{2,3}"})+$</p>
            <p class="text-gray-600 dark:text-gray-400">匹配常见邮箱格式</p>
          </div>
        </div>

        <!-- 场景2 -->
        <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4">
          <h3 class="font-semibold text-gray-800 dark:text-gray-200 mb-2">提取URL</h3>
          <div class="space-y-2 text-sm">
            <p class="font-mono text-blue-600 dark:text-blue-400 break-words">https?:\/\/(?:[-\w]+\.)+[-\w]+(?:[-\w\/.%&?=]*)?</p>
            <p class="text-gray-600 dark:text-gray-400">提取网页URL链接</p>
          </div>
        </div>

        <!-- 场景3 -->
        <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4">
          <h3 class="font-semibold text-gray-800 dark:text-gray-200 mb-2">匹配电话号码</h3>
          <div class="space-y-2 text-sm">
            <p class="font-mono text-blue-600 dark:text-blue-400 break-words">(\+?\d{"{1,3}"}[- ]?)?\(?\d{"{2,3}"}\)?[- ]?\d{"{3,4}"}[- ]?\d{"{4}"}</p>
            <p class="text-gray-600 dark:text-gray-400">匹配多种格式的电话号码</p>
          </div>
        </div>

        <!-- 场景4 -->
        <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4">
          <h3 class="font-semibold text-gray-800 dark:text-gray-200 mb-2">提取HTML标签</h3>
          <div class="space-y-2 text-sm">
            <p class="font-mono text-blue-600 dark:text-blue-400 break-words">&lt;([a-zA-Z][a-zA-Z0-9]*)\b[^&gt;]*&gt;(.*?)&lt;\/\1&gt;</p>
            <p class="text-gray-600 dark:text-gray-400">提取HTML标签及内容</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</Layout>

<style>
  /* 为 mark 标签添加样式 */
  mark {
    background-color: #fef3c7;
    padding: 0.125rem 0.25rem;
    border-radius: 0.25rem;
  }
  
  .dark mark {
    background-color: #92400e;
  }

  /* 表格样式优化 */
  table td {
    padding: 0.5rem 1rem;
    font-size: 0.875rem;
  }

  table tr:nth-child(even) {
    background-color: rgba(0, 0, 0, 0.02);
  }

  .dark table tr:nth-child(even) {
    background-color: rgba(255, 255, 255, 0.02);
  }
</style>
